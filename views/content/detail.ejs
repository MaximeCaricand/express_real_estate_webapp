<script type="text/javascript" src="/js/detail.js"></script>
<link rel="stylesheet" href="/css/detail.css">

<div id="startPage" class="container">
    <div class="row">

        <% var imagesExists = (params.ad.src_images != undefined); %>

        <!-- Div allowing to overlay the main image of the ad and the red cross if the property is sold/rent -->
        <div class="col-sm">
            <!-- Main image that is displayed -->
            <div class="text-center">
                <img id="myImageView" class="replace-2x img-responsive b-lazy b-loaded"
                src="../../../<%= (imagesExists ? params.ad.src_images[0] : "images/none.jpg") %>"
                alt="<%= params.ad.title %>" title="<%= params.ad.title %>" itemprop="image" height="230px"/>
            </div>

            <!-- List of all the images linked to the ad. When clicking on one of them, the main image displayed (above) is replaced by the selected one -->
            <div class="listImage">
                <% if(imagesExists) { %>
                <% for(var ind = 0; ind < params.ad.src_images.length; ind++) { %>
                <img class="imgSelection" src="../../../<%= params.ad.src_images[ind] %>" width="40px" height="40px"
                    onclick="switchImage('../../../<%= params.ad.src_images[ind] %>')" />
                <% } %>
                <% } %>
            </div>
        </div>

        <!-- Div to display the most important information about the property (Title, price, availability, type, availability date) -->
        <div class="col-sm-4">
            <% var isAvailable = params.ad.propertyStatus === "Available"; %>

            <h2 class="textColorProperty" style="margin-bottom: 0;"><%= params.ad.title %></h2>
            <i id="<%= (isAvailable ? "selectAdDispo" : "selectAdIndispo") %>">
                <%= (isAvailable ?
                    "Available " :
                    "UNAVAILABLE ")
                %>

                <% if (isAvailable) { %>
                <%= (params.ad.type === "Sale" ?
                    "for sale" :
                    "for rent")
                %>
                <% } %>
            </i>

            <br><br><br>
            <h3 class="textColorProperty">
                Price : <%= params.ad.price %> € <%= (params.ad.propertyType === "Rent" ? " / month " : "") %> 
            </h3>

            <br><br>
            <p class="text-start fs-4">Available from : <%= params.ad.date %></p>
        </div>
    </div>

    <hr class="bg-danger border-2 border-top border-danger">

    <!-- Row to display the entire content of the property description -->
    <div class="row">
        <div class="gx-4 gx-lg-5 justify-content-center">
            <div>
                <h2 class="textColorProperty">Description of the property</h2>

                <p>
                <% if(params.ad.description != undefined) { %> 
                    <% let splitDescipt = params.ad.description.split('\n'); %>
                
                    <% for(let ind=0; ind<splitDescipt.length; ind++) { %> 
                    <%= splitDescipt[ind] %><br>
                    <% } %>
                <% } %>
                </p>
            </div>
        </div>
    </div>

    <hr class="bg-danger border-2 border-top border-danger">

    <!-- Row permettant d'afficher tout les commentaires liés a ce bien -->
    <div class="row">
        <div class="gx-4 gx-lg-5 justify-content-center">
            <div>
                <h2 class="textColorProperty">Comments</h2>
    
                <h5 class="textColorProperty">Ask your question :</h5>
                <div class="form-row">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="askQuestion" placeholder="What is your question ?">
                        <button class="btn btn-outline-secondary" type="button" onclick="addQuestion()">Confirm</button>
                    </div>
                </div>

                <% if(params.ad.comments != undefined && params.ad.comments.length > 0) { %>
                <h5 class="textColorProperty">The asked questions :</h5>
                <div class="form-row">
                    <% for(let indQuest=0; indQuest<params.ad.comments.length; indQuest++) { %> 
                    <div class="form-group col-md">
                      <label for="question<%= indQuest+1 %>">Question <%= indQuest+1 %> : <b><%= params.ad.comments[indQuest].question %></b></label>

                      <select id="question<%= indQuest+1 %>" class="form-control">
                        <% if(params.ad.comments[indQuest].answers != undefined) { %>
                        <% for(let indAns=0; indAns<params.ad.comments[indQuest].answers.length; indAns++) { %> 
                        <option><%= params.ad.comments[indQuest].answers[indAns] %></option>
                        <% } %>
                        <% } %>
                      </select>

                    </div>
                    <% } %>
                </div>
                <% } %>
            </div>
        </div>
    </div>

</div>

<br><br><br><br>